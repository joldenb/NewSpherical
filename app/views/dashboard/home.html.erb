<div id="user_area" ng-controller="UserCtrl">
    <div id="users_controls">
        <div class="control_panels" ng-repeat="panel in controlPanels">
            <div class="panel" ng-class="{highlight: panel.highlight}" ng-style="panel.bg" highlight-panel click-panel panelobj="panel"><h3>{{panel.text}}<br />{{panel.current_user}}</h3></div>
        </div>
    </div>
    <div class="expand" ng-class="panelstate.classes" ng-show="panelstate.visible">
        <div ui-view="ctrlpanel"></div>
    </div>
</div>

<div id="dashlogo"><img alt="" ng-src="{{spheredata.dashlogo}}"></div>


<div ng-controller="ActivityCtrl" class="activity_ctrl">
    <div class="topic-swiper" topic-swiper slidearray="spheredata.topics"></div>

    <div class="controls_bar">
        <div class="topic_controls">
            <div class="control" topic-cntrl-btn btntarget="all" tool-tip>
                <span ng-class="{active:currentTopicIdx >= 0}">&nbsp;</span>
                <div class="tooltip_above">All Topics<div class="arrow">&nbsp;</div></div>   
            </div>
            <div class="control" topic-cntrl-btn btntarget="previous" tool-tip>
                <span ng-class="{active:currentTopicIdx > 0}" style="background-position:-21px 0;">&nbsp;</span>
                <div class="tooltip_above">Previous Topic<div class="arrow">&nbsp;</div></div>
            </div>
            <div class="control" topic-cntrl-btn btntarget="next" tool-tip>
                <span ng-class="{active:(currentTopicIdx < spheredata.num_topics-1 && currentTopicIdx >= 0)}" style="background-position:-46px 0;">&nbsp;</span>
                <div class="tooltip_above">Next Topic<div class="arrow">&nbsp;</div></div>
            </div>
            <div class="control_rt" btntarget="new_discussion" tool-tip>
                <span class="discussion" ng-class="{active: signedin}">&nbsp;</span>
                <div class="tooltip_above twoln">Start a New Discussion<div class="arrow">&nbsp;</div></div>
            </div>
        </div>
    </div>

    <div class="activity_window">
        <div class="topic_indicator" id="{{currentTopic.id}}">
            <h3 ng-show="topicIndicatorVisible">{{currentTopic.name}}</h3>
            <h4 ng-click="activityShow('stories')">Stories</h4>
            <h4 ng-click="activityShow('discussions')">Discussions</h4>
        </div>
        <div class="item_display">
            <div class="item-swiper" ng-show="storiesVisible" item-swiper itemarray="topicItems"></div>
            <div class="discussions" ng-controller="MainForumCtrl">
                <div class="post">
                    <div class="post_banner">
                        <h3>Post</h3>
                    </div>
                </div>
                <div class="forum">
                    <div class="forum_banner">
                        <h3>Discussion</h3>
                        <div class="forum_posting">
                            <div class="presence_indicator">Now present: <span class="present">{{forum.presence_counter}}</span>
                            <div class="comment_oc" comment-oc highlight-button>Comment</div></div>
                            <div class="forum_posting_form" ng-show="forum.form_visible">
                                <form novalidate>
                                    <fieldset>
                                        <textarea class="forum_post_text" name="forum_post_text" placeholder="Write a comment..." rows="4" ng-model="forum_post_text"></textarea>
                                    </fieldset>
                                </form>
                                <div class="forum_post_menu">
                                    <button class="post_button" ng-click="forum.submit_post()" highlight-button>Post...</button>
                                    <div ng-class="{red: forum.error_fdbk}" class="feedback" ng-show="forum.show_fdbk">{{forum.fdbk}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="spacer"></div>
                    <div class="forum_posts">
                        <div ng-repeat="post in forum.posts">
                            <div class="forum_post">
                                <div class="author_img" post-author-image imgaddr="post.thumb"></div>
                                <p class="author">by <span ng-class="{present: forum.is_present(post.author)}">{{post.author}}</span><br />{{post.timestamp}} ago</p>
                                <p class="forum_text">{{post.text}}</p>
                            </div>
                        </div>
                    </div>
                    

                    
                </div>
            </div>
        </div>
    </div>
</div>